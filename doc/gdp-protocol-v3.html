<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <title>GDP Protocol</title>
    <style type="text/css">
.note {
  font-style: italic;
  background-color: #ffff99;
}

</style></head>
  <body>
    <h1> GDP Protocol Version 3<br>
    </h1>
    <h4>Eric Allman, Ubiquitous Swarm Lab, U.C. Berkeley<br>
      Draft Document Version 0.32, 2017-04-14<br>
    </h4>
    <br>
    <p>Note: this document uses the term "Protocol Data Unit" (PDU) instead of
      "packet" to avoid confusion with a possible implementation on top of a
      packet-based protocol such as UDP.<br>
    </p>
    <p>This describes the redesign of the GDP protocol designed to fit better
      into a datagram routing model.&nbsp; The previous design was for version
      0.1 of the GDP, which was connection based and did not allow for the
      extended PDU format.<br>
    </p>
    <p class="note"><em><strong class="note">NOTE WELL</strong>: There are two
        proposals for the "Standard Format" PDU.&nbsp; If you have any
        suggestions as to which one is better, please contact me.&nbsp; The
        first is the one currently implemented.</em><br>
    </p>
    <p>This document uses the term "payload" somewhat ambiguously.&nbsp; Until
      that is fixed, assume that payload refers to the data portion of the PDU,
      and excludes the optional header fields such as record number and
      timestamp.<br>
    </p>
    <h2>Model and Expectations of the Routing Layer</h2>
    <p>We assume the routing layer will give us:</p>
    <ul>
      <li>Variable length protocol data units (previously but incorrectly called
        "packets").</li>
      <li>Arbitrary length PDUs (so layering on top of fixed length protocols
        such as UDP will require PDU fragmentation and reassembly).</li>
      <li>Reliable, ordered delivery (so layers may need to be added to address
        retransmission, out-of-order receipt, and duplication receipt if using
        datagram-based protocols).</li>
      <li>Basic integrity checks (e.g., checksums) are provided by the transport
        layer.</li>
    </ul>
    <p>Note that higher-level timeouts and retransmissions are necessary.&nbsp;
      For example, if a client requests a record but the responding Log Daemon
      terminates before responding, the client has to time out and preferably
      retry the request.&nbsp; It isn't clear that the PDU contains enough
      information to provide perfect reliability.<br>
    </p>
    <ul>
    </ul>
    <h2> Terminology</h2>
    <dl>
      <dt>GCL</dt>
      <dd>Global Data Plane Channel/Log.&nbsp; This represents an addressable
        entity in the Global Data Plane, which may be a log or a service.<br>
      </dd>
    </dl>
    <h2>PDU Specification</h2>
    <p>All numeric fields in Protocol Data Units are represented in network byte
      order ("Big Endian").<br>
    </p>
    <p>Protocol Data Units begin as follows:<br>
    </p>
    <table border="1" cellpadding="2" cellspacing="2" width="100%">
      <tbody>
        <tr>
          <td align="center" valign="top" width="25%">PDU Version/Format<br>
            (1 octet)<br>
          </td>
          <td align="center" valign="top" width="75%">Defined by Format<br>
            (variable length)<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>The PDU Version/Format define the interpretation of the rest of the
      packet.&nbsp; This documents defines two formats as described below.&nbsp;
      Programs must verify that they understand the version before attempting
      further interpretation of the PDU.&nbsp; Defined Version/Formats are:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="30%">
      <tbody>
        <tr>
          <td align="center" valign="top">Value<br>
          </td>
          <td valign="top">Description<br>
          </td>
        </tr>
        <tr>
          <td align="center" valign="top">0x03<br>
          </td>
          <td valign="top">Standard format<br>
          </td>
        </tr>
        <tr>
          <td align="center" valign="top">0x0f<br>
          </td>
          <td valign="top">Extended format<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Other formats are reserved.<br>
    </p>
    <h3>Standard Format (0x03)<br>
    </h3>
    <table border="1" cellpadding="2" cellspacing="2" height="310" width="100%">
      <tbody>
        <tr>
          <td align="center" valign="top" width="25%">0x03<br>
            (1 octet)<br>
          </td>
          <td align="center" valign="top" width="25%">Time to Live<br>
            (1 octet) </td>
          <td align="center" valign="top" width="25%">Reserved<br>
            (1 octet) </td>
          <td align="center" valign="top" width="25%">Cmd/Ack<br>
            (1 octet)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top"><br>
            Destination (32 octets)<br>
            <br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top"><br>
            Source (32 octets)<br>
            <br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top">Request Id (4 octets)<br>
          </td>
        </tr>
        <tr>
          <td colspan="2" rowspan="1" align="center" valign="top">Signature Info<br>
            (2 octets)<br>
          </td>
          <td colspan="1" rowspan="1" align="center" valign="top">Optionals
            Length<br>
            (1 octet)<br>
          </td>
          <td align="center" valign="top">Flags<br>
            (1 octet)<br>
          </td>
        </tr>
        <tr>
          <td colspan="4" rowspan="1" align="center" valign="top">Data Length<br>
            (4 octets)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top">Record Number
            (8 octets, optional)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top">Sequence
            Number (8 octets, optional)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top"><br>
            Commit Timestamp (16 octets, optional)<br>
            <br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top">Additional
            optional header fields (variable length)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" align="center" valign="top">Data (variable
            length)<br>
          </td>
        </tr>
        <tr>
          <td rowspan="1" colspan="4" align="center" valign="top">Signature
            (variable length)<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <p>Time to Live (1 octet).&nbsp; The originator of the packet sets a number
      of hops that this packet is allowed to take.&nbsp; At each hop the routing
      layer must decrement this field; if it reaches zero it is assumed that the
      packet is looping.<br>
    </p>
    <p>Reserved (1 octet).&nbsp; Must be zero when the PDU is created and
      ignored when the PDU is read.&nbsp; Forwarders must transmit this field
      unchanged.<br>
    </p>
    <p>Cmd/Ack (1 octet).&nbsp; This is the client-to-server command or
      server-to-client ack or nack.&nbsp; In some cases it can be a command to
      the routing layer (see below).</p>
    <p>Destination (32 octets).&nbsp; The destination for this PDU.&nbsp; The
      special value consisting of alternating 255 bytes and zero bytes ("<tt>ff00ff00</tt>...")
      indicates messages to be interpreted by the routing layer.</p>
    <p> </p>
    <p>Source (32 octets).&nbsp; The source of this PDU.&nbsp; For data
      originating from a named GCL it will be the name of that GCL; otherwise it
      will be the address of the program instance, which in general will change
      when the program is restarted.<br>
    </p>
    <p>Signature Info (2 octets).&nbsp; The message digest and signature
      length.&nbsp; If this is zero there is no signature.&nbsp; The top four
      bits indicate the message digest algorithm:</p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top">Name<br>
          </td>
          <td valign="top">Numeric Value<br>
          </td>
          <td valign="top">Interpretation/Reference<br>
          </td>
        </tr>
        <tr>
          <td>MD_NULL</td>
          <td>0x0000</td>
          <td>no digest</td>
        </tr>
        <tr>
          <td valign="top">MD_SHA1<br>
          </td>
          <td valign="top">0x1000<br>
          </td>
          <td valign="top">SHA-1 (160 bit) (FIPS PUB 180-1) </td>
        </tr>
        <tr>
          <td valign="top">MD_SHA224<br>
          </td>
          <td valign="top">0x2000<br>
          </td>
          <td valign="top">SHA-2 (224 bit) (FIPS PUB 180-3)<br>
          </td>
        </tr>
        <tr>
          <td valign="top">MD_SHA256<br>
          </td>
          <td valign="top">0x3000<br>
          </td>
          <td style="height: 19.2px;" valign="top">SHA-2 (256 bit) (FIPS PUB
            180-3) </td>
        </tr>
        <tr>
          <td>MD_SHA384</td>
          <td>0x4000</td>
          <td>SHA-2 (384 bit) (FIPS PUB 180-3)</td>
        </tr>
        <tr>
          <td>MD_SHA512</td>
          <td>0x5000</td>
          <td>SHA-2 (512 bit) (FIPS PUB 180-3)</td>
        </tr>
      </tbody>
    </table>
    <p>The bottom 12 bits gives the signature length in octets.&nbsp; <span><em
          class="note">[[Do we need the digest algorithm?&nbsp; It allows each
          record to use a different algorithm, and means we have to store this
          with each record.&nbsp; On the other hand, this could be construed as
          an advantage.&nbsp; If this information isn't in the PDU then it has
          to be stored in the log metadata.]]</em></span></p>
    <p> </p>
    <p> </p>
    <p>Optionals Length (1 octet).&nbsp; The number of octets of optional header
      data in units of four octets (for example, a value of 2 means that there
      are 8 bytes of optional data).&nbsp; This is the number of octets from the
      end of the Data Length field to the beginning of the Data field.<br>
    </p>
    <p>Flags (1 octet).&nbsp; Used to interpret the optional area of the
      PDU.&nbsp; Flags exist for:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top">Name<br>
          </td>
          <td valign="top">Numeric Value<br>
          </td>
          <td valign="top">Interpretation<br>
          </td>
        </tr>
        <tr>
          <td valign="top">HAS_RECNO<br>
          </td>
          <td valign="top">0x02<br>
          </td>
          <td valign="top">The Record Number field is included in this PDU.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">HAS_SEQNO<br>
          </td>
          <td valign="top">0x04<br>
          </td>
          <td valign="top">The Sequence Number field is included in this PDU.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">HAS_TS<br>
          </td>
          <td valign="top">0x08<br>
          </td>
          <td valign="top">The Commit Timestamp field is included in this PDU.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <p>Data Length (4 octets).&nbsp; This gives the length of the Data field in
      octets.&nbsp; It does <i>not</i> include the signature.&nbsp; <span class="note">[[Note
        that this limits data records to 2<sup>32</sup><i> </i>bytes.&nbsp;
        This is intentional since 32-bit machines won't be able to manipulate
        larger records.&nbsp; To change this would require allowing record
        fragments to be transmitted.&nbsp; This might be a good idea in the face
        of streaming data, but would require significant changes to this
        protocol and the programmatic API.]]</span><br>
    </p>
    <p>Request Id (4 octets).&nbsp; A value to disambiguate calls in
      progress.&nbsp; Requests (commands) are correlated with responses on the
      basis of the concatenation of Destination, Source, and Request Id; if
      Destination and Source are unambiguous (i.e., there will never be more
      than one command active between the Source and the Destination at any one
      time) the Request Id can be omitted (that is, defaulted to zero).&nbsp;
      Use of the Request Id is common for subscriptions.<br>
    </p>
    <p>Record Number (8 octets; optional).&nbsp; Contains the record number to
      read, or the first record number for a subscribe or multiread; in
      responses it contains the actual record number.&nbsp; PUBLISH commands
      must contain the next record number (i.e., records cannot be written more
      than once and there can be no gaps).<br>
    </p>
    <p>Sequence Number (8 octets; optional).&nbsp; When the PDU is signed, this
      field is included with the signature to avoid replay attacks.&nbsp; It
      must be strictly increasing.&nbsp; [[Across all time?&nbsp; How is this
      stored in the GCL?]]<br>
    </p>
    <p>Commit Timestamp (16 octets; optional).&nbsp; Contains the commit
      timestamp on received data.&nbsp; [[Merge with Sequence Number??]]</p>
    <p> </p>
    <p> </p>
    <p> </p>
    <p>Data (variable length).&nbsp; From the perspective of the GDP, this is an
      opaque field, preferably encrypted.<br>
    </p>
    <p>Signature (length as described above; optional).<br>
    </p>
    <h3>Discussion</h3>
    <ul>
      <li>The point of specifying the signature algorithm and size explicitly in
        the header rather than in the PDU Extended Format is three-fold: (1)
        using an PDU Extended Format field is expected to be fairly heavy
        weight, both in terms of PDU overhead and in processing; (2) the PDU
        Extended Format will ideally only apply to the data itself so that low
        level code can remain lean and mean; and (3) the Extended Format has not
        yet been understood, and we need to proceed.<br>
      </li>
      <li>The signature itself is at the end of the PDU so it can be computed
        while the data is being written.</li>
      <li>It's unclear whether we need the sequence number.</li>
    </ul>
    <h3>Alternative Standard Format <i>[NOT IMPLEMENTED]</i><br>
    </h3>
    <p class="note">[[An alternative to the prior version uses a more flexible
      way of encoding options at the expense of more complexity when sending or
      receiving PDUs.&nbsp; We have to pick one or the other.&nbsp; For the time
      being we've gone with the simpler approach.]]<br>
    </p>
    <table border="1" cellpadding="2" cellspacing="2" height="310" width="100%">
      <tbody>
        <tr>
          <td colspan="1" rowspan="1" align="center" valign="top" width="25%">(TBD)<br>
            (1 octet)<br>
          </td>
          <td align="center" valign="top" width="25%">Time to Live<br>
            (1 octet) </td>
          <td colspan="1" rowspan="1" align="center" valign="top" width="25%">Reserved<br>
            (1 octet)<br>
          </td>
          <td align="center" valign="top" width="25%">Cmd/Ack<br>
            (1 octet)</td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top"><br>
            Destination (32 octets)<br>
            <br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top"><br>
            Source (32 octets)<br>
            <br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="2" rowspan="1" valign="top" width="12%">Signature Info<br>
            (2 octets)<br>
          </td>
          <td rowspan="1" colspan="1" valign="top">#Options<br>
            (1 octet)<br>
          </td>
          <td valign="top">Reserved<br>
            (1 octet)<br>
          </td>
        </tr>
        <tr>
          <td colspan="4" rowspan="1" align="center" valign="top">Data Length<br>
            (4 octets)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top">Optional field names and
            sizes (variable length)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top">Optional fields (variable
            length)<br>
          </td>
        </tr>
        <tr align="center">
          <td colspan="4" rowspan="1" valign="top">Data (variable length)<br>
          </td>
        </tr>
        <tr>
          <td colspan="4" align="center" valign="top">Signature (variable
            length)<br>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
    </ul>
    <p>There are #Options octets in the List of Optional field names and
      sizes.&nbsp; Each octet describes both the option and the length of that
      option.&nbsp; The bottom four bits encode the length:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="30%">
      <tbody>
        <tr>
          <td valign="top">0<br>
          </td>
          <td valign="top">0<br>
          </td>
        </tr>
        <tr>
          <td valign="top">1<br>
          </td>
          <td valign="top">1<br>
          </td>
        </tr>
        <tr>
          <td valign="top">2<br>
          </td>
          <td valign="top">2<br>
          </td>
        </tr>
        <tr>
          <td valign="top">3<br>
          </td>
          <td valign="top">4<br>
          </td>
        </tr>
        <tr>
          <td valign="top">4<br>
          </td>
          <td valign="top">6<br>
          </td>
        </tr>
        <tr>
          <td valign="top">5<br>
          </td>
          <td valign="top">8<br>
          </td>
        </tr>
        <tr>
          <td valign="top">6<br>
          </td>
          <td valign="top">12<br>
          </td>
        </tr>
        <tr>
          <td valign="top">7<br>
          </td>
          <td valign="top">16<br>
          </td>
        </tr>
        <tr>
          <td valign="top">8<br>
          </td>
          <td valign="top">24<br>
          </td>
        </tr>
        <tr>
          <td valign="top">9<br>
          </td>
          <td valign="top">32<br>
          </td>
        </tr>
        <tr>
          <td valign="top">10&ndash;14<br>
          </td>
          <td valign="top">reserved<br>
          </td>
        </tr>
        <tr>
          <td valign="top">15<br>
          </td>
          <td valign="top">variable<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>If the bottom four bits of the name are "15" then the following octet is
      used as the number of octets.<br>
    </p>
    <p>Defined options are:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="50%">
      <tbody>
        <tr>
          <td valign="top">0x03<br>
          </td>
          <td valign="top">Request ID (4 octets)<br>
          </td>
        </tr>
        <tr>
          <td valign="top">0x05<br>
          </td>
          <td valign="top">Record Number (8 octets)<br>
          </td>
        </tr>
        <tr>
          <td valign="top">0x15<br>
          </td>
          <td valign="top">Sequence Number (8 octets)<br>
          </td>
        </tr>
        <tr>
          <td valign="top">0x07<br>
          </td>
          <td valign="top">Commit Timestamp (16 octets)<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Option values are encoded after all the option identifiers.&nbsp; <i>[[Should
        option fields be padded to land on aligned boundaries.&nbsp; Sample text
        might read:]]</i> Option values are padded out to the lesser of their
      length or four.&nbsp; For this purpose, variable length options are not
      padded.&nbsp; That is, one octet and variable length options have no
      additional padding, two octet options are padded to two octet alignment,
      and all others are padded to four octet alignments.&nbsp; <i>[[Question:
        should this go up to eight octet alignment for x86_64 architectures?]]</i><br>
    </p>
    <p><br>
    </p>
    <h3>Extended Format (0x0F)&nbsp; <i>[NOT YET IMPLEMENTED]</i><br>
    </h3>
    <table border="1" cellpadding="2" cellspacing="2" width="100%">
      <tbody>
        <tr>
          <td align="center" valign="top" width="25%">0x0f<br>
            (1 octet)<br>
          </td>
          <td colspan="1" rowspan="1" align="center" valign="top" width="75%">Defined
            by Extended PDU Format<br>
            (3 octets)<br>
          </td>
        </tr>
        <tr>
          <td colspan="4" rowspan="1" valign="top"><br>
            <div align="center"> Extended PDU Format (32 octets)<br>
            </div>
            <br>
          </td>
        </tr>
        <tr>
          <td colspan="4" rowspan="1" align="center" valign="top">Additional
            data as defined by the Extended PDU Format<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Extended PDU Format (32 octets).&nbsp; The format is (conceptually) a
      pointer to a program that interprets the packet.&nbsp; If this is set, all
      fields following this field are potentially open to reinterpretation by a
      PDU description language program referenced by this field.&nbsp; The
      semantics of such a program are [[for future study]]. </p>
    <p> </p>
    <h2>Command/Acknowledgement Set</h2>
    <p><i>NOTE: this section still needs more details about the payload formats
        for the various commands.</i><br>
    </p>
    <h3>Overview<br>
    </h3>
    <p>Commands and Acknowledgements (both positive and negative) are encoded
      into one byte, and are inspired by CoAP (which is itself inspired by
      HTTP).&nbsp; They are broken up into semantic sections based on the top
      few bits:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top">Bits<br>
          </td>
          <td valign="top">Meaning<br>
          </td>
        </tr>
        <tr>
          <td valign="top">00x<br>
          </td>
          <td valign="top">Unacknowledged ("blind") commands.&nbsp; These
            correspond to CoAP "non-confirmable" (type 1) messages.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">01x<br>
          </td>
          <td valign="top">Acknowledged commands.&nbsp; These correspond to CoAP
            "confirmable" (type 0) messages.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">10x<br>
          </td>
          <td valign="top">Positive acknowledgement.&nbsp; These (and the
            following negative acknowlegement) correspond to CoAP
            "acknowledgement" (type 2) messages.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">110<br>
          </td>
          <td valign="top">Negative acknowledgement, client side problem.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">111<br>
          </td>
          <td valign="top">Negative acknowledgement, server side problem or
            router error.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="note"><i>[[Note: these values may need adjustment depending on how
        the protocol expands; e.g., perhaps only 64 ack/nak codes are needed
        rather than 128 in order to expand the number of commands.]]</i><br>
    </p>
    <h3>Commands</h3>
    <p>This section is an overview; see the next section for details.<br>
    </p>
    <p>Blind commands are not acknowledged.&nbsp; They have values 0 through
      63.&nbsp; Defined values are:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top">Name<br>
          </td>
          <td valign="top">Value<br>
          </td>
          <td valign="top">Meaning<br>
          </td>
        </tr>
        <tr>
          <td valign="top">CMD_KEEPALIVE<br>
          </td>
          <td valign="top">0<br>
          </td>
          <td valign="top">Sent to keep a connection alive (essentially
            No-Operation).<br>
          </td>
        </tr>
        <tr>
          <td valign="top">CMD_ADVERTISE<br>
          </td>
          <td valign="top">1<br>
          </td>
          <td valign="top">Advertise willingness to respond for a given
            Destination Address.&nbsp; Should only be addressed to the Routing
            Layer.&nbsp; Advertising is described below.<br>
          </td>
        </tr>
        <tr>
          <td valign="top">CMD_WITHDRAW<br>
          </td>
          <td valign="top">2<br>
          </td>
          <td valign="top">Withdraw advertisement.&nbsp; Should only be
            addressed to the Routing Layer.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>All Acknowledged commands (values 64 through 127) are answered with an
      Acknowledgement, which may be positive (success) or negative
      (failure).&nbsp; Acknowledged commands are:<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top" width="30%">Name<br>
          </td>
          <td valign="top">Value<br>
          </td>
          <td valign="top">Meaning<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_PING<br>
          </td>
          <td valign="top">64<br>
          </td>
          <td valign="top">Test connection.&nbsp; The payload is reflected back
            in the acknowledgement.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_HELLO<br>
          </td>
          <td valign="top">65<br>
          </td>
          <td valign="top">Negotiate extensions.&nbsp; Currently unimplemented.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_CREATE [Note: This will change in the
            future!<br>
          </td>
          <td valign="top">66<br>
          </td>
          <td valign="top">Create a GCL.&nbsp; It must be addressed to the Log
            Daemon instance on which the data should be stored.&nbsp; The data
            contains the name of the new GCL and the GCL metadata.&nbsp; It is
            an error if the GCL already exists.&nbsp; <span class="note">[[Need
              to have creations moderated by a creation service.]]</span><br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_OPEN_AO<br>
          </td>
          <td valign="top">67<br>
          </td>
          <td valign="top">Open a GCL for append only.&nbsp; The GCL must
            already exist.&nbsp; This command is not required, but it can be
            used to test for the existence of a GCL and pre-allocate resources.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_OPEN_RO<br>
          </td>
          <td valign="top">68<br>
          </td>
          <td valign="top">Open a GCL for read only.&nbsp; This is not required,
            but can be used to test for the existence of a GCL.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_CLOSE<br>
          </td>
          <td valign="top">69<br>
          </td>
          <td valign="top">Close a GCL.&nbsp; This is not required.&nbsp; It is
            just a hint to the server that resources will not be needed soon.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_READ<br>
          </td>
          <td valign="top">70<br>
          </td>
          <td valign="top">Read a given record number.&nbsp; The record number
            is in the optional part of the header.&nbsp; The data portion is
            unused.&nbsp; The response is ACK_CONTENT containing the requested
            data or NAK_C_NOTFOUND.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_APPEND<br>
          </td>
          <td valign="top">71<br>
          </td>
          <td valign="top">Append a record to a GCL.&nbsp; The payload contains
            the data to write.&nbsp; In the future, this must be signed.&nbsp;
            The returned ACK_CREATED message contains the record number and the
            commit timestamp.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_SUBSCRIBE<br>
          </td>
          <td valign="top">72<br>
          </td>
          <td valign="top">Subscribe to a GCL.&nbsp; The Record Number header
            field contains the first record number to return and the data
            contains the number of records to return.&nbsp; In the future, a
            timeout may be included.&nbsp; This will cause ACK_CONTENT commands
            to be returned as data becomes ready.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_MULTIREAD<br>
          </td>
          <td valign="top">73<br>
          </td>
          <td valign="top">Return multiple records.&nbsp; This works similarly
            to SUBSCRIBE except that it terminates immediately when all existing
            records are returned.<br>
          </td>
        </tr>
        <tr>
          <td valign="top" width="30%">CMD_GETMETADATA<br>
          </td>
          <td valign="top">74<br>
          </td>
          <td valign="top">Return GCL metadata.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">CMD_OPEN_RA</td>
          <td style="vertical-align: top; background-color: white;">75</td>
          <td style="vertical-align: top; background-color: white;">Open GCL for
            read and/or append.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">CMD_NEWSEGMENT</td>
          <td style="vertical-align: top; background-color: white;">76</td>
          <td style="vertical-align: top; background-color: white;">Create a new
            segment for a GCL.&nbsp; This creates a new data file for a
            log.&nbsp; This is a physical operation only: there are no semantic
            differences between records in different segments.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">CMD_FWD_APPEND</td>
          <td style="vertical-align: top; background-color: white;">77</td>
          <td style="vertical-align: top; background-color: white;">Forward an
            APPEND command to another server.&nbsp; Internal use only.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">CMD_UNSUBSCRIBE</td>
          <td style="vertical-align: top; background-color: white;">78</td>
          <td style="vertical-align: top; background-color: white;">Delete all
            subscriptions for a given {log, client} pair.&nbsp; This is implied
            on close.</td>
        </tr>
      </tbody>
    </table>
    <h3>Acknowledgements<br>
    </h3>
    <p>Acknowledgement codes are chosen to correspond to CoAP/HTTP reply codes
      where possible, with preference given to CoAP.&nbsp; Values 128&ndash;191
      are Positive Acknowledgements, 192&ndash;223 are Client-Side Negative
      Acknowledgements, 224&ndash;239 are Server-Side Negative Acknowledgements,
      and 240&ndash;254 are Routing-Layer Negative Acknowledgements.<br>
    </p>
    <table align="center" border="1" cellpadding="2" cellspacing="2" width="90%">
      <tbody>
        <tr>
          <td valign="top">Name<br>
          </td>
          <td valign="top">Value<br>
          </td>
          <td valign="top">CoAP/HTTP<br>
            Equivalent<br>
          </td>
          <td valign="top">Meaning<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_SUCCESS<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">128<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">&ndash;/&ndash;<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Generic
            operation succeeded.&nbsp; The payload depends on the command being
            acknowledged.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_CREATED<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">129<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">2.01/201<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">New
            resource created.&nbsp; If the resource is a log record (e.g., in
            response to CMD_PUBLISH) a record number and timestamp will be
            included in the header.&nbsp; The payload is empty.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_DELETED<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">130<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">2.02/204<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Resource
            deleted.&nbsp; The payload is empty. </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_VALID<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">131<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">2.03/304<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_CHANGED<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">132<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">2.04/204<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Resource
            changed.&nbsp; The payload is empty. </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">ACK_CONTENT<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">133<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">2.05/200<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Content
            returned.&nbsp; A record number and timestamp may be included
            depending on the data (for example, it is included for log records
            but omitted for log metadata).&nbsp; The payload contains the
            content and the signature.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_BADREQ<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">192<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.00/400<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Invalid
            request.&nbsp; The payload is empty.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_UNAUTH<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">193<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.01/&ndash;<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_BADOPT<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">194<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.02/&ndash;<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">A
            bad option value was supplied, e.g., a negative record count in a
            subscribe.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_FORBIDDEN<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">195<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.03/403<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_NOTFOUND<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">196<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.04/404<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_METHNOTALLOWED<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">197<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.05/405<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_NOTACCEPTABLE<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">198<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.06/406<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_CONFLICT<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">201<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">&ndash;/409<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_PRECONFAILED<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">204<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.12/412<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_TOOLARGE<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">205<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.13/413<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_C_UNSUPMEDIA<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">207<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">4.15/415<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">NAK_C_MISSING_RECORD</td>
          <td style="vertical-align: top; background-color: white;">222</td>
          <td style="vertical-align: top; background-color: white;"><br>
          </td>
          <td style="vertical-align: top; background-color: white;">A request
            was made for a record that is not available.&nbsp; This implies that
            there are higher numbered records possibly available.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">NAK_C_REC_DUP</td>
          <td style="vertical-align: top; background-color: white;">223</td>
          <td style="vertical-align: top; background-color: white;"><br>
          </td>
          <td style="vertical-align: top; background-color: white;">There are
            multiple versions of the same record number.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_INTERNAL<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">224<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.00/500<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Internal
            server error.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_NOTIMPL<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">225<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.01/501<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Indicates
            that the GDP doesn't implement the requested function; for example,
            unrecognized command codes get this response.<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_BADGATEWAY<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">226<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.02/502<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_SVCUNAVAIL<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">227<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.03/503<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_GWTIMEOUT<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">228<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.04/504<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_PROXYNOTSUP<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">229<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">5.05/&ndash;<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><i>Not
              currently used.</i> </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;">NAK_S_REPLICATE_FAIL</td>
          <td style="vertical-align: top; background-color: white;">238</td>
          <td style="vertical-align: top; background-color: white;">&mdash;</td>
          <td style="vertical-align: top; background-color: white;">Server was
            not able to write a sufficient number of replicas.</td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_S_EXITING<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">239<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">&ndash;<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Log
            server is exiting (subscriptions will be terminated).<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top; background-color: white;" valign="top">NAK_R_NOROUTE<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">240<br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top"><br>
          </td>
          <td style="vertical-align: top; background-color: white;" valign="top">Generated
            by the routing layer to indicate that it couldn't find an
            advertisement for the requested destination.&nbsp; The source
            address in the PDU is the unroutable address.&nbsp; <i>[[Should
              this use the routing layer address as the source and put the
              unroutable address in the data?]]</i><br>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="note">[[TODO: Show which ack/naks can correspond to each
      command.]]<br>
    </p>
    <h2>Details of Commands<br>
    </h2>
    <h3>Advertisements (CMD_ADVERTISE, CMD_WITHDRAW)<br>
    </h3>
    <p>A node advertises its willingness to respond on behalf of one or more
      256-bit names using advertisements.&nbsp; All connected nodes <strong>must</strong>
      offer at least one advertisement in the form of their own name, which may
      not be withdrawn unless they are shutting down.&nbsp; Advertisements (and
      withdrawals) <strong>must</strong> be addressed to the routing layer
      (that is, the Destination field must be the distinguished name of the
      routing layer).&nbsp; The Source field <strong>must</strong> be the name
      of the advertising or withdrawing entity; for advertisements (not
      withdrawals) the Source will be implicitly advertised.&nbsp; The data
      payload <strong>may</strong> contain additional names to advertise or
      withdraw.<br>
    </p>
    <p class="note">[[Should advertisements include some notation of capability,
      e.g., "this is a log server", "this is a client", etc.?]]<br>
    </p>
    <h3>Option Negotiation (CMD_HELLO)<br>
    </h3>
    <p>[[For future use.]]<br>
    </p>
    <h3>GCL Creation (CMD_CREATE)</h3>
    <p><i><b>At the moment this command is in an interim form.&nbsp; It will
          change in the future.</b></i><br>
    </p>
    <p>Currently, attempts to create a GCL must be directed to a specific Log
      Daemon (i.e., the destination field in the PDU is that of the daemon
      itself, not the name of the log to be created).&nbsp; The name of the log
      is contained in the payload.&nbsp; The name is followed by optional
      metadata which will be associated with the new GCL.<br>
    </p>
    <p>[[Need separate service to do location placement, resource balancing,
      etc.&nbsp; A bit issue will be key management; you don't want to have
      every log server respond to the same secret key (that wouldn't be very
      private!), but there has to be some way to do things cross-ADMD.]]<br>
    </p>
    <h3>GCL Open and Close (CMD_OPEN_AO, CMD_OPEN_RO, CMD_CLOSE)</h3>
    <p>[[All optional.]]<br>
    </p>
    <h3> </h3>
    <h3>On-Wire GCL Metadata Format (CMD_CREATE, CMD_GETMETADATA)<br>
    </h3>
    <p>The format of on-wire metadata is defined in the document <a href="gdp-gcl-metadata.html">GDP
        GCL Metadata</a>.<br>
    </p>
    <h3>Reading Data (CMD_READ, CMD_MULTIREAD, CMD_SUBSCRIBE)</h3>
    <p>The READ command is addressed to the GCL to be read.&nbsp; The record
      number to read is given in the Record Number field in the PDU
      header.&nbsp; The payload is unused.<br>
    </p>
    <p>The MULTIREAD command returns multiple records.&nbsp; It is addressed to
      the GCL to be read.&nbsp; The record number in the header is the number of
      the first record to be read; if this is negative it starts relative to the
      last record, so if a log has five records numbered 1&ndash;5, a start of
      &ndash;3 returns records 3, 4, and 5.&nbsp; The payload has a 32-bit
      record count.&nbsp; The data is returned using a stream of ACK_CONTENTS
      PDUs, each of which contains the data in the payload.&nbsp; The data
      stream ends when the record count is met or the end of the log, whichever
      comes first.<br>
    </p>
    <p>The SUBSCRIBE command is the same as MULTIREAD, the only difference being
      that the data stream continues beyond the end of the log &mdash; so
      subscriptions may continue indefinitely into the future.<br>
    </p>
    <h3>Writing Data (CMD_APPEND)</h3>
    <p>The append command is directed to the GCL to be written.&nbsp; The
      payload is the data to be added.&nbsp; In the future, this will be
      required to have a signature field.<br>
    </p>
    <p class="note">[[Talk about signing, interaction with metadata.]]<br>
    </p>
    <h2>Details of Acknowledgements</h2>
    <p>Client errors are due to a problem in the client-supplied request, such
      as "not found".&nbsp; These are expected to be common.&nbsp; Server errors
      are due to a problem in the server implementation or configuration; these
      are expected to be rare.&nbsp; There may be some overlap.&nbsp; For
      example, NAK_S_NOTIMPL is a server error, but may occur because a client
      issued an unknown command.&nbsp; <span class="note">[[Should this be
        changed?]]</span><br>
    </p>
    <p>The Routing Layer can give feedback about the routing.&nbsp; In
      particular, it can inform a client that it couldn't deliver a PDU to the
      requested destination using NAK_R_NOROUTE.<br>
    </p>
    <p class="note">[[TODO: write me.&nbsp; Need to define semantics and show
      payloads.]]<br>
    </p>
    <p> </p>
    <h2>Protocol Operation</h2>
    <p>Note that there are two models for different actors in the GDP.&nbsp; One
      is the logical model where there are clients that initiate requests (e.g.,
      sensor clients posting data to a GCL) and servers that process requests
      (e.g., GDP Log daemons that collect that data and store it).&nbsp; This is
      similar to standard Internet services such as email.&nbsp; The second is a
      routing model, where both clients and servers initiate communication with
      the routing layer; in the classic Internet view both these actors are
      "clients" and only the routing layer has "servers".&nbsp; In this
      description we use "initiators" to indicate actors that initiate
      communications with the routing layer, both clients and servers.&nbsp;
      Note that the "client" and "server" roles are not necessarily mutually
      exclusive; a single actor might provide both functions.<br>
    </p>
    <p class="note">[[TODO: Flesh out this section]]<br>
    </p>
    <ol>
      <li>Initiator does discovery to find an available GDP Router node.&nbsp; <span
          class="note">[[TODO: how? &mdash; in the short run this is probably
          just a run-time configuration parameter.]]</span></li>
      <li>Initiator connects to GDP Router node (connection-based protocol only;
        datagram-based protocols skip this step).</li>
      <li>Initiator sends an advertisement to the routing layer specifying its
        256-bit name.&nbsp; The routing layer notes this so that other nodes can
        address the initiator.</li>
      <li>(Optional)&nbsp; Initiator advertises the 256-bit names of any
        resources it cares to make available.&nbsp; For example, a GDP Log node
        would advertise the names of the GCLs it had available.</li>
      <li>Initiator starts listening for incoming requests, possibly in a
        separate thread.&nbsp; For example, even sensor nodes must respond to
        heartbeats from the routing layer.<br>
      </li>
      <li>(Optional) Client interacts with the world and issues requests to the
        GDP via the routing layer.</li>
      <li>(Optional) If an initiator knows that it is shutting down, it will
        preferably inform the routing layer of that fact beforehand so resources
        can be released promptly.&nbsp; If this is not done the routing layer
        will discover that based on timeouts.</li>
      <li>(Optional) If a router node knows it must shut down, it will
        preferably inform all of its initiators of that fact so they can find
        another router node (i.e., goto step 1).&nbsp; This can also be
        discovered based on timeouts.<br>
      </li>
    </ol>
    <h2>Signatures</h2>
    <p class="note">[[TODO: write me; in particular, need to understand how to
      avoid replay attacks.]]<br>
    </p>
    <p>[[Question: what needs to be signed?&nbsp; Certainly publish and create
      requests.&nbsp; Probably not read or subscribe.&nbsp; Acks/Nacks?]]<br>
    </p>
    <p>[[What gets signed?&nbsp; Just the data, the entire PDU, or some portion
      of the PDU?&nbsp; If just the data then the header (including the address
      and signature metadata) must be protected by some other mechanism.&nbsp;
      If more than just the data, then storing the signature with the data
      doesn't make sense &mdash; unless what is stored is the entire PDU.]]<br>
    </p>
    <h2>Security Considerations</h2>
    <p>The data content is completely opaque to the GDP and is expected to be
      encrypted (there are some exceptions, e.g., GCL metadata).&nbsp; However,
      the header metadata is always plaintext.&nbsp; This suggests certain
      possible attacks.<br>
    </p>
    <ul>
      <li>An eavesdropper can do traffic analysis to determine who is
        communicating with whom and on what schedule.</li>
      <li>A man-in-the-middle (MitM) can prevent traffic in both directions,
        thereby <br>
      </li>
    </ul>
    <p class="note">[[TODO: fill this in.&nbsp; It needs to talk about denial of
      service, forgery, etc.&nbsp; Signatures should probably be a subsection.]]<br>
    </p>
    <h2> </h2>
  </body>
</html>
